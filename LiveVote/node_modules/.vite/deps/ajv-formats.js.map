{
  "version": 3,
  "sources": ["../../ajv-formats/src/formats.ts", "../../ajv-formats/src/limit.ts", "../../ajv-formats/src/index.ts"],
  "sourcesContent": ["import type {Format, FormatDefinition} from \"ajv\"\r\nimport type {FormatValidator, FormatCompare} from \"ajv/dist/types\"\r\n\r\nexport type FormatMode = \"fast\" | \"full\"\r\n\r\nexport type FormatName =\r\n  | \"date\"\r\n  | \"time\"\r\n  | \"date-time\"\r\n  | \"duration\"\r\n  | \"uri\"\r\n  | \"uri-reference\"\r\n  | \"uri-template\"\r\n  | \"url\"\r\n  | \"email\"\r\n  | \"hostname\"\r\n  | \"ipv4\"\r\n  | \"ipv6\"\r\n  | \"regex\"\r\n  | \"uuid\"\r\n  | \"json-pointer\"\r\n  | \"json-pointer-uri-fragment\"\r\n  | \"relative-json-pointer\"\r\n  | \"byte\"\r\n  | \"int32\"\r\n  | \"int64\"\r\n  | \"float\"\r\n  | \"double\"\r\n  | \"password\"\r\n  | \"binary\"\r\n\r\nexport type DefinedFormats = {\r\n  [key in FormatName]: Format\r\n}\r\n\r\nfunction fmtDef(\r\n  validate: RegExp | FormatValidator<string>,\r\n  compare: FormatCompare<string>\r\n): FormatDefinition<string> {\r\n  return {validate, compare}\r\n}\r\n\r\nexport const fullFormats: DefinedFormats = {\r\n  // date: http://tools.ietf.org/html/rfc3339#section-5.6\r\n  date: fmtDef(date, compareDate),\r\n  // date-time: http://tools.ietf.org/html/rfc3339#section-5.6\r\n  time: fmtDef(time, compareTime),\r\n  \"date-time\": fmtDef(date_time, compareDateTime),\r\n  // duration: https://tools.ietf.org/html/rfc3339#appendix-A\r\n  duration: /^P(?!$)((\\d+Y)?(\\d+M)?(\\d+D)?(T(?=\\d)(\\d+H)?(\\d+M)?(\\d+S)?)?|(\\d+W)?)$/,\r\n  uri,\r\n  \"uri-reference\":\r\n    /^(?:[a-z][a-z0-9+\\-.]*:)?(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'\"()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'\"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\\?(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'\"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,\r\n  // uri-template: https://tools.ietf.org/html/rfc6570\r\n  \"uri-template\":\r\n    /^(?:(?:[^\\x00-\\x20\"'<>%\\\\^`{|}]|%[0-9a-f]{2})|\\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\\*)?)*\\})*$/i,\r\n  // For the source: https://gist.github.com/dperini/729294\r\n  // For test cases: https://mathiasbynens.be/demo/url-regex\r\n  url: /^(?:https?|ftp):\\/\\/(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)(?:\\.(?:[a-z0-9\\u{00a1}-\\u{ffff}]+-)*[a-z0-9\\u{00a1}-\\u{ffff}]+)*(?:\\.(?:[a-z\\u{00a1}-\\u{ffff}]{2,})))(?::\\d{2,5})?(?:\\/[^\\s]*)?$/iu,\r\n  email:\r\n    /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,\r\n  hostname:\r\n    /^(?=.{1,253}\\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\\.?$/i,\r\n  // optimized https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9780596802837/ch07s16.html\r\n  ipv4: /^(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)$/,\r\n  ipv6: /^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))$/i,\r\n  regex,\r\n  // uuid: http://tools.ietf.org/html/rfc4122\r\n  uuid: /^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,\r\n  // JSON-pointer: https://tools.ietf.org/html/rfc6901\r\n  // uri fragment: https://tools.ietf.org/html/rfc3986#appendix-A\r\n  \"json-pointer\": /^(?:\\/(?:[^~/]|~0|~1)*)*$/,\r\n  \"json-pointer-uri-fragment\": /^#(?:\\/(?:[a-z0-9_\\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,\r\n  // relative JSON-pointer: http://tools.ietf.org/html/draft-luff-relative-json-pointer-00\r\n  \"relative-json-pointer\": /^(?:0|[1-9][0-9]*)(?:#|(?:\\/(?:[^~/]|~0|~1)*)*)$/,\r\n  // the following formats are used by the openapi specification: https://spec.openapis.org/oas/v3.0.0#data-types\r\n  // byte: https://github.com/miguelmota/is-base64\r\n  byte,\r\n  // signed 32 bit integer\r\n  int32: {type: \"number\", validate: validateInt32},\r\n  // signed 64 bit integer\r\n  int64: {type: \"number\", validate: validateInt64},\r\n  // C-type float\r\n  float: {type: \"number\", validate: validateNumber},\r\n  // C-type double\r\n  double: {type: \"number\", validate: validateNumber},\r\n  // hint to the UI to hide input strings\r\n  password: true,\r\n  // unchecked string payload\r\n  binary: true,\r\n}\r\n\r\nexport const fastFormats: DefinedFormats = {\r\n  ...fullFormats,\r\n  date: fmtDef(/^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d$/, compareDate),\r\n  time: fmtDef(\r\n    /^(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)?$/i,\r\n    compareTime\r\n  ),\r\n  \"date-time\": fmtDef(\r\n    /^\\d\\d\\d\\d-[0-1]\\d-[0-3]\\d[t\\s](?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)(?:\\.\\d+)?(?:z|[+-]\\d\\d(?::?\\d\\d)?)$/i,\r\n    compareDateTime\r\n  ),\r\n  // uri: https://github.com/mafintosh/is-my-json-valid/blob/master/formats.js\r\n  uri: /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/)?[^\\s]*$/i,\r\n  \"uri-reference\": /^(?:(?:[a-z][a-z0-9+\\-.]*:)?\\/?\\/)?(?:[^\\\\\\s#][^\\s#]*)?(?:#[^\\\\\\s]*)?$/i,\r\n  // email (sources from jsen validator):\r\n  // http://stackoverflow.com/questions/201323/using-a-regular-expression-to-validate-an-email-address#answer-8829363\r\n  // http://www.w3.org/TR/html5/forms.html#valid-e-mail-address (search for 'wilful violation')\r\n  email:\r\n    /^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,\r\n}\r\n\r\nexport const formatNames = Object.keys(fullFormats) as FormatName[]\r\n\r\nfunction isLeapYear(year: number): boolean {\r\n  // https://tools.ietf.org/html/rfc3339#appendix-C\r\n  return year % 4 === 0 && (year % 100 !== 0 || year % 400 === 0)\r\n}\r\n\r\nconst DATE = /^(\\d\\d\\d\\d)-(\\d\\d)-(\\d\\d)$/\r\nconst DAYS = [0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]\r\n\r\nfunction date(str: string): boolean {\r\n  // full-date from http://tools.ietf.org/html/rfc3339#section-5.6\r\n  const matches: string[] | null = DATE.exec(str)\r\n  if (!matches) return false\r\n  const year: number = +matches[1]\r\n  const month: number = +matches[2]\r\n  const day: number = +matches[3]\r\n  return (\r\n    month >= 1 &&\r\n    month <= 12 &&\r\n    day >= 1 &&\r\n    day <= (month === 2 && isLeapYear(year) ? 29 : DAYS[month])\r\n  )\r\n}\r\n\r\nfunction compareDate(d1: string, d2: string): number | undefined {\r\n  if (!(d1 && d2)) return undefined\r\n  if (d1 > d2) return 1\r\n  if (d1 < d2) return -1\r\n  return 0\r\n}\r\n\r\nconst TIME = /^(\\d\\d):(\\d\\d):(\\d\\d)(\\.\\d+)?(z|[+-]\\d\\d(?::?\\d\\d)?)?$/i\r\n\r\nfunction time(str: string, withTimeZone?: boolean): boolean {\r\n  const matches: string[] | null = TIME.exec(str)\r\n  if (!matches) return false\r\n\r\n  const hour: number = +matches[1]\r\n  const minute: number = +matches[2]\r\n  const second: number = +matches[3]\r\n  const timeZone: string = matches[5]\r\n  return (\r\n    ((hour <= 23 && minute <= 59 && second <= 59) ||\r\n      (hour === 23 && minute === 59 && second === 60)) &&\r\n    (!withTimeZone || timeZone !== \"\")\r\n  )\r\n}\r\n\r\nfunction compareTime(t1: string, t2: string): number | undefined {\r\n  if (!(t1 && t2)) return undefined\r\n  const a1 = TIME.exec(t1)\r\n  const a2 = TIME.exec(t2)\r\n  if (!(a1 && a2)) return undefined\r\n  t1 = a1[1] + a1[2] + a1[3] + (a1[4] || \"\")\r\n  t2 = a2[1] + a2[2] + a2[3] + (a2[4] || \"\")\r\n  if (t1 > t2) return 1\r\n  if (t1 < t2) return -1\r\n  return 0\r\n}\r\n\r\nconst DATE_TIME_SEPARATOR = /t|\\s/i\r\nfunction date_time(str: string): boolean {\r\n  // http://tools.ietf.org/html/rfc3339#section-5.6\r\n  const dateTime: string[] = str.split(DATE_TIME_SEPARATOR)\r\n  return dateTime.length === 2 && date(dateTime[0]) && time(dateTime[1], true)\r\n}\r\n\r\nfunction compareDateTime(dt1: string, dt2: string): number | undefined {\r\n  if (!(dt1 && dt2)) return undefined\r\n  const [d1, t1] = dt1.split(DATE_TIME_SEPARATOR)\r\n  const [d2, t2] = dt2.split(DATE_TIME_SEPARATOR)\r\n  const res = compareDate(d1, d2)\r\n  if (res === undefined) return undefined\r\n  return res || compareTime(t1, t2)\r\n}\r\n\r\nconst NOT_URI_FRAGMENT = /\\/|:/\r\nconst URI =\r\n  /^(?:[a-z][a-z0-9+\\-.]*:)(?:\\/?\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\\.[a-z0-9\\-._~!$&'()*+,;=:]+)\\]|(?:(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)\\.){3}(?:25[0-5]|2[0-4]\\d|[01]?\\d\\d?)|(?:[a-z0-9\\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\\d*)?(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\\/(?:(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\\/(?:[a-z0-9\\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\\?(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i\r\n\r\nfunction uri(str: string): boolean {\r\n  // http://jmrware.com/articles/2009/uri_regexp/URI_regex.html + optional protocol + required \".\"\r\n  return NOT_URI_FRAGMENT.test(str) && URI.test(str)\r\n}\r\n\r\nconst BYTE = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm\r\n\r\nfunction byte(str: string): boolean {\r\n  BYTE.lastIndex = 0\r\n  return BYTE.test(str)\r\n}\r\n\r\nconst MIN_INT32 = -(2 ** 31)\r\nconst MAX_INT32 = 2 ** 31 - 1\r\n\r\nfunction validateInt32(value: number): boolean {\r\n  return Number.isInteger(value) && value <= MAX_INT32 && value >= MIN_INT32\r\n}\r\n\r\nfunction validateInt64(value: number): boolean {\r\n  // JSON and javascript max Int is 2**53, so any int that passes isInteger is valid for Int64\r\n  return Number.isInteger(value)\r\n}\r\n\r\nfunction validateNumber(): boolean {\r\n  return true\r\n}\r\n\r\nconst Z_ANCHOR = /[^\\\\]\\\\Z/\r\nfunction regex(str: string): boolean {\r\n  if (Z_ANCHOR.test(str)) return false\r\n  try {\r\n    new RegExp(str)\r\n    return true\r\n  } catch (e) {\r\n    return false\r\n  }\r\n}\r\n", "import type Ajv from \"ajv\"\r\nimport type {\r\n  Plugin,\r\n  CodeKeywordDefinition,\r\n  KeywordErrorDefinition,\r\n  Code,\r\n  Name,\r\n  ErrorObject,\r\n} from \"ajv\"\r\nimport type {AddedFormat} from \"ajv/dist/types\"\r\nimport type {Rule} from \"ajv/dist/compile/rules\"\r\nimport {KeywordCxt} from \"ajv\"\r\nimport {_, str, or, getProperty, operators} from \"ajv/dist/compile/codegen\"\r\n\r\ntype Kwd = \"formatMaximum\" | \"formatMinimum\" | \"formatExclusiveMaximum\" | \"formatExclusiveMinimum\"\r\n\r\ntype Comparison = \"<=\" | \">=\" | \"<\" | \">\"\r\n\r\nconst ops = operators\r\n\r\nconst KWDs: {[K in Kwd]: {okStr: Comparison; ok: Code; fail: Code}} = {\r\n  formatMaximum: {okStr: \"<=\", ok: ops.LTE, fail: ops.GT},\r\n  formatMinimum: {okStr: \">=\", ok: ops.GTE, fail: ops.LT},\r\n  formatExclusiveMaximum: {okStr: \"<\", ok: ops.LT, fail: ops.GTE},\r\n  formatExclusiveMinimum: {okStr: \">\", ok: ops.GT, fail: ops.LTE},\r\n}\r\n\r\nexport type LimitFormatError = ErrorObject<Kwd, {limit: string; comparison: Comparison}>\r\n\r\nconst error: KeywordErrorDefinition = {\r\n  message: ({keyword, schemaCode}) => str`should be ${KWDs[keyword as Kwd].okStr} ${schemaCode}`,\r\n  params: ({keyword, schemaCode}) =>\r\n    _`{comparison: ${KWDs[keyword as Kwd].okStr}, limit: ${schemaCode}}`,\r\n}\r\n\r\nexport const formatLimitDefinition: CodeKeywordDefinition = {\r\n  keyword: Object.keys(KWDs),\r\n  type: \"string\",\r\n  schemaType: \"string\",\r\n  $data: true,\r\n  error,\r\n  code(cxt) {\r\n    const {gen, data, schemaCode, keyword, it} = cxt\r\n    const {opts, self} = it\r\n    if (!opts.validateFormats) return\r\n\r\n    const fCxt = new KeywordCxt(it, (self.RULES.all.format as Rule).definition, \"format\")\r\n    if (fCxt.$data) validate$DataFormat()\r\n    else validateFormat()\r\n\r\n    function validate$DataFormat(): void {\r\n      const fmts = gen.scopeValue(\"formats\", {\r\n        ref: self.formats,\r\n        code: opts.code.formats,\r\n      })\r\n      const fmt = gen.const(\"fmt\", _`${fmts}[${fCxt.schemaCode}]`)\r\n      cxt.fail$data(\r\n        or(\r\n          _`typeof ${fmt} != \"object\"`,\r\n          _`${fmt} instanceof RegExp`,\r\n          _`typeof ${fmt}.compare != \"function\"`,\r\n          compareCode(fmt)\r\n        )\r\n      )\r\n    }\r\n\r\n    function validateFormat(): void {\r\n      const format = fCxt.schema as string\r\n      const fmtDef: AddedFormat | undefined = self.formats[format]\r\n      if (!fmtDef || fmtDef === true) return\r\n      if (\r\n        typeof fmtDef != \"object\" ||\r\n        fmtDef instanceof RegExp ||\r\n        typeof fmtDef.compare != \"function\"\r\n      ) {\r\n        throw new Error(`\"${keyword}\": format \"${format}\" does not define \"compare\" function`)\r\n      }\r\n      const fmt = gen.scopeValue(\"formats\", {\r\n        key: format,\r\n        ref: fmtDef,\r\n        code: opts.code.formats ? _`${opts.code.formats}${getProperty(format)}` : undefined,\r\n      })\r\n\r\n      cxt.fail$data(compareCode(fmt))\r\n    }\r\n\r\n    function compareCode(fmt: Name): Code {\r\n      return _`${fmt}.compare(${data}, ${schemaCode}) ${KWDs[keyword as Kwd].fail} 0`\r\n    }\r\n  },\r\n  dependencies: [\"format\"],\r\n}\r\n\r\nconst formatLimitPlugin: Plugin<undefined> = (ajv: Ajv): Ajv => {\r\n  ajv.addKeyword(formatLimitDefinition)\r\n  return ajv\r\n}\r\n\r\nexport default formatLimitPlugin\r\n", "import {\r\n  DefinedFormats,\r\n  FormatMode,\r\n  FormatName,\r\n  formatNames,\r\n  fastFormats,\r\n  fullFormats,\r\n} from \"./formats\"\r\nimport formatLimit from \"./limit\"\r\nimport type Ajv from \"ajv\"\r\nimport type {Plugin, Format} from \"ajv\"\r\nimport {_, Name} from \"ajv/dist/compile/codegen\"\r\n\r\nexport {FormatMode, FormatName} from \"./formats\"\r\nexport {LimitFormatError} from \"./limit\"\r\nexport interface FormatOptions {\r\n  mode?: FormatMode\r\n  formats?: FormatName[]\r\n  keywords?: boolean\r\n}\r\n\r\nexport type FormatsPluginOptions = FormatName[] | FormatOptions\r\n\r\nexport interface FormatsPlugin extends Plugin<FormatsPluginOptions> {\r\n  get: (format: FormatName, mode?: FormatMode) => Format\r\n}\r\n\r\nconst fullName = new Name(\"fullFormats\")\r\nconst fastName = new Name(\"fastFormats\")\r\n\r\nconst formatsPlugin: FormatsPlugin = (\r\n  ajv: Ajv,\r\n  opts: FormatsPluginOptions = {keywords: true}\r\n): Ajv => {\r\n  if (Array.isArray(opts)) {\r\n    addFormats(ajv, opts, fullFormats, fullName)\r\n    return ajv\r\n  }\r\n  const [formats, exportName] =\r\n    opts.mode === \"fast\" ? [fastFormats, fastName] : [fullFormats, fullName]\r\n  const list = opts.formats || formatNames\r\n  addFormats(ajv, list, formats, exportName)\r\n  if (opts.keywords) formatLimit(ajv)\r\n  return ajv\r\n}\r\n\r\nformatsPlugin.get = (name: FormatName, mode: FormatMode = \"full\"): Format => {\r\n  const formats = mode === \"fast\" ? fastFormats : fullFormats\r\n  const f = formats[name]\r\n  if (!f) throw new Error(`Unknown format \"${name}\"`)\r\n  return f\r\n}\r\n\r\nfunction addFormats(ajv: Ajv, list: FormatName[], fs: DefinedFormats, exportName: Name): void {\r\n  ajv.opts.code.formats ??= _`require(\"ajv-formats/dist/formats\").${exportName}`\r\n  for (const f of list) ajv.addFormat(f, fs[f])\r\n}\r\n\r\nmodule.exports = exports = formatsPlugin\r\nObject.defineProperty(exports, \"__esModule\", {value: true})\r\n\r\nexport default formatsPlugin\r\n"],
  "mappings": "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",
  "names": []
}
